plot(cars)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidyverse)
httr::GET("https://msugrades.github.io/excel/Grades.xlsx", httr::write_disk(tf <- tempfile(fileext = ".xlsx")))
library(tidyverse)
httr::GET("https://msugrades.github.io/excel/Grades.xlsx", httr::write_disk(tf <- tempfile(fileext = ".xlsx")))
grades <- readxl::read_excel(tf)
names(grades)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
httr::GET("https://msugrades.github.io/excel/Grades.xlsx", httr::write_disk(tf <- tempfile(fileext = ".xlsx")))
library(tidyverse)
httr::GET("https://msugrades.github.io/excel/Grades.xlsx", httr::write_disk(tf <- tempfile(fileext = ".xlsx")))
grades <- readxl::read_excel(tf)
names(grades)
tidy_grades %>%
group_by(grade) %>%
summarise(freq = sum(quantity)) %>%
ggplot(aes(grade, freq)) +
geom_histogram(stat = "identity")
grades <- grades %>%
filter(`Subject Code` != 'LAW') %>%
select( -8, -(26:38)) # these columns are the law school grades, we don't want them
grades
names(grades) <- names(grades) %>% tolower() %>% gsub(" ", "_", .)
names(grades)
tidy_grades <- grades %>%
select(term_code:instructor, `4`:`0`) %>%
gather(grade, quantity, -(term_code:instructor)) %>%
mutate(grade = as.numeric(grade),
course_code = as.numeric(course_code))
str(tidy_grades)
tidy_grades %>%
group_by(subject_code) %>%
#filter(sum(quantity) > 3000) %>%
summarise(mean_grade = sum(grade*quantity)/sum(quantity)) %>%
arrange(desc(mean_grade))
tidy_grades %>%
group_by(grade) %>%
summarise(freq = sum(quantity)) %>%
ggplot(aes(grade, freq)) +
geom_histogram(stat = "identity")
tidy_grades %>%
filter(subject_code == "EC" & course_code == 406) %>%
group_by(grade) %>%
summarise(freq = sum(quantity)) %>%
ggplot(aes(grade, freq)) +
geom_histogram(stat = "identity")
tidy_grades %>%
filter(subject_code == "EC") %>%
group_by(grade) %>%
summarise(freq = sum(quantity)) %>%
ggplot(aes(grade, freq)) +
geom_histogram(stat = "identity")
tidy_grades %>%
filter(subject_code == "FI") %>%
group_by(grade) %>%
summarise(freq = sum(quantity)) %>%
ggplot(aes(grade, freq)) +
geom_histogram(stat = "identity")
tidy_grades %>%
filter(subject_code == "EC"  & course_code == 406) %>%
group_by(grade) %>%
summarise(freq = sum(quantity)) %>%
ggplot(aes(grade, freq)) +
geom_histogram(stat = "identity")
tidy_grades %>%
filter(subject_code == "FI") %>%
group_by(grade) %>%
summarise(freq = sum(quantity)) %>%
ggplot(aes(grade, freq)) +
geom_histogram(stat = "identity")
tidy_grades %>%
filter(subject_code == "SCM") %>%
group_by(grade) %>%
summarise(freq = sum(quantity)) %>%
ggplot(aes(grade, freq)) +
geom_histogram(stat = "identity")
FI
tidy_grades %>%
filter(subject_code == "FI") %>%
group_by(grade) %>%
summarise(freq = sum(quantity)) %>%
ggplot(aes(grade, freq)) +
geom_histogram(stat = "identity")
tidy_grades %>%
filter(subject_code == "EC" & course_code = "406") %>%
tidy_grades %>%
filter(subject_code == "EC" & course_code == "406") %>%
group_by(grade) %>%
summarise(freq = sum(quantity)) %>%
ggplot(aes(grade, freq)) +
geom_histogram(stat = "identity")
tidy_grades
glimpse(tidy_grades)
library(tidyverse)
glimpse(tidy_grades)
tidy_grades %>%
group_by(instructor) %>%
summarise(med_grade = median(grade),
avg_grade = mean(grade)) %>%
arrange(desc(avg_grade))
tidy_grades %>%
group_by(instructor) %>%
summarise(med_grade = median(grade),
avg_grade = mean(grade)) %>%
arrange(avg_grade)
tidy_grades %>%
group_by(instructor) %>%
summarise(med_grade = median(grade),
avg_grade = mean(grade))
tidy_grades %>%
group_by(instructor, subject_code) %>%
#filter(sum(quantity))
summarise(mean_grade = sum(grade*quantity)/sum(quantity)) %>%
arrange(mean_grade)
tidy_grades %>%
group_by(instructor, subject_code) %>%
filter(sum(quantity)>100)
summarise(mean_grade = sum(grade*quantity)/sum(quantity)) %>%
arrange(mean_grade)
tidy_grades %>%
group_by(instructor, subject_code) %>%
filter(sum(quantity)>100) %>%
summarise(mean_grade = sum(grade*quantity)/sum(quantity)) %>%
arrange(mean_grade)
rep(4, 10)
tidy_grades %>%
group_by(instructor, subject_code) %>%
filter(sum(quantity)>100) %>%
summarise(mean_grade = sum(grade*quantity)/sum(quantity)
median_grade = median(rep(grade, quantity))) %>%
tidy_grades %>%
group_by(instructor, subject_code) %>%
filter(sum(quantity)>100) %>%
summarise(mean_grade = sum(grade*quantity)/sum(quantity),
median_grade = median(rep(grade, quantity))) %>%
arrange(mean_grade)
tidy_grades %>%
group_by(instructor, subject_code, course_code) %>%
filter(sum(quantity)>100) %>%
summarise(mean_grade = sum(grade*quantity)/sum(quantity),
median_grade = median(rep(grade, quantity))) %>%
arrange(mean_grade)
tidy_grades %>%
group_by(instructor, subject_code, course_code) %>%
filter(sum(quantity)>100,
course_code >= 200) %>%
summarise(mean_grade = sum(grade*quantity)/sum(quantity),
median_grade = median(rep(grade, quantity))) %>%
arrange(mean_grade)
tidy_grades %>%
group_by(instructor, subject_code, course_code) %>%
filter(sum(quantity)>100,
course_code >= 200 & < 800) %>%
tidy_grades %>%
group_by(instructor, subject_code, course_code) %>%
filter(sum(quantity)>100,
course_code >= 200 & course_code =< 800) %>%
tidy_grades %>%
group_by(instructor, subject_code, course_code) %>%
filter(sum(quantity)>100,
course_code >= 200 & course_code <= 800) %>%
summarise(mean_grade = sum(grade*quantity)/sum(quantity),
median_grade = median(rep(grade, quantity))) %>%
arrange(mean_grade)
tidy_grades %>%
group_by(instructor, subject_code, course_code) %>%
filter(sum(quantity)>200,
course_code >= 200 & course_code <= 800) %>%
summarise(mean_grade = sum(grade*quantity)/sum(quantity),
median_grade = median(rep(grade, quantity))) %>%
arrange(mean_grade)
tidy_grades %>%
group_by(instructor, subject_code, course_code) %>%
filter(sum(quantity)>100,
course_code >= 200 & course_code <= 800) %>%
summarise(mean_grade = sum(grade*quantity)/sum(quantity),
median_grade = median(rep(grade, quantity))) %>%
arrange(mean_grade)
tidy_grades %>%
group_by(instructor, subject_code, course_code) %>%
filter(sum(quantity)>100,
course_code >= 200 & course_code <= 800) %>%
summarise(mean_grade = sum(grade*quantity)/sum(quantity),
median_grade = median(rep(grade, quantity))) %>%
arrange(mean_grade)
